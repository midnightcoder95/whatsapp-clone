{"ast":null,"code":"import _slicedToArray from\"/home/ujwal/Desktop/projects/whatsapp-clone-firebase/whatsapp-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import\"./Chat.css\";import{Avatar,IconButton}from\"@material-ui/core\";import{MoreVert,AttachFile,SearchOutlined}from\"@material-ui/icons\";import InsertEmoticonIcon from\"@material-ui/icons/InsertEmoticon\";import MicIcon from\"@material-ui/icons/Mic\";import{useParams}from\"react-router-dom\";import db from\"./firebase\";import{useStateValue}from\"./StateProvider\";import firebase from\"firebase\";function Chat(){var _messages,_messages$timestamp;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),input=_useState2[0],setInput=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),seed=_useState4[0],setSeed=_useState4[1];var _useParams=useParams(),roomId=_useParams.roomId;var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),roomName=_useState6[0],setRoomName=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];var _useStateValue=useStateValue(),_useStateValue2=_slicedToArray(_useStateValue,2),user=_useStateValue2[0].user,dispatch=_useStateValue2[1];useEffect(function(){if(roomId){db.collection(\"rooms\").doc(roomId).onSnapshot(function(snapshot){return setRoomName(snapshot.data().name);});db.collection(\"rooms\").doc(roomId).collection(\"messages\").orderBy(\"timestamp\",\"asc\").onSnapshot(function(snapshot){return setMessages(snapshot.docs.map(function(doc){return doc.data();}));});}},[roomId]);useEffect(function(){setSeed(Math.floor(Math.random()*5000));},[]);var sendMessage=function sendMessage(e){e.preventDefault();console.log(\"You typed >>>\",input);db.collection(\"rooms\").doc(roomId).collection(\"messages\").add({message:input,name:user.displayName,timestamp:firebase.firestore.FieldValue.serverTimestamp()});setInput(\"\");};return/*#__PURE__*/React.createElement(\"div\",{className:\"chat\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat__header\"},/*#__PURE__*/React.createElement(Avatar,{src:\"https://avatars.dicebear.com/api/human/\".concat(seed,\".svg\")}),/*#__PURE__*/React.createElement(\"div\",{className:\"chat__headerInfo\"},/*#__PURE__*/React.createElement(\"h3\",null,roomName),/*#__PURE__*/React.createElement(\"p\",null,\"sast seen\",\" \",new Date((_messages=messages[messages.length-1])===null||_messages===void 0?void 0:(_messages$timestamp=_messages.timestamp)===null||_messages$timestamp===void 0?void 0:_messages$timestamp.toDate()).toUTCString())),/*#__PURE__*/React.createElement(\"div\",{className:\"chat__headerRight\"},/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(SearchOutlined,null)),/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(AttachFile,null)),/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(MoreVert,null)))),/*#__PURE__*/React.createElement(\"div\",{className:\"chat__body\"},messages.map(function(message){var _message$timestamp;return/*#__PURE__*/React.createElement(\"p\",{className:\"chat__message \".concat(message.name==user.displayName&&\"chat__receiver\")},/*#__PURE__*/React.createElement(\"span\",{className:\"chat__name\"},message.name),message.message,/*#__PURE__*/React.createElement(\"span\",{className:\"chat__timestamp\"},new Date((_message$timestamp=message.timestamp)===null||_message$timestamp===void 0?void 0:_message$timestamp.toDate()).toUTCString()));})),/*#__PURE__*/React.createElement(\"div\",{className:\"chat__footer\"},/*#__PURE__*/React.createElement(InsertEmoticonIcon,null),/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"input\",{value:input,onChange:function onChange(e){return setInput(e.target.value);},placeholder:\"Type a message\",type:\"text\"}),/*#__PURE__*/React.createElement(\"button\",{onClick:sendMessage,type:\"submit\"},\"Send a message\")),/*#__PURE__*/React.createElement(MicIcon,null)));}export default Chat;","map":{"version":3,"sources":["/home/ujwal/Desktop/projects/whatsapp-clone-firebase/whatsapp-clone/src/Chat.js"],"names":["React","useEffect","useState","Avatar","IconButton","MoreVert","AttachFile","SearchOutlined","InsertEmoticonIcon","MicIcon","useParams","db","useStateValue","firebase","Chat","input","setInput","seed","setSeed","roomId","roomName","setRoomName","messages","setMessages","user","dispatch","collection","doc","onSnapshot","snapshot","data","name","orderBy","docs","map","Math","floor","random","sendMessage","e","preventDefault","console","log","add","message","displayName","timestamp","firestore","FieldValue","serverTimestamp","Date","length","toDate","toUTCString","target","value"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport \"./Chat.css\";\nimport { Avatar, IconButton } from \"@material-ui/core\";\nimport { MoreVert, AttachFile, SearchOutlined } from \"@material-ui/icons\";\nimport InsertEmoticonIcon from \"@material-ui/icons/InsertEmoticon\";\nimport MicIcon from \"@material-ui/icons/Mic\";\nimport { useParams } from \"react-router-dom\";\nimport db from \"./firebase\";\nimport { useStateValue } from \"./StateProvider\";\nimport firebase from \"firebase\";\n\nfunction Chat() {\n  const [input, setInput] = useState(\"\");\n  const [seed, setSeed] = useState(\"\");\n  const { roomId } = useParams();\n  const [roomName, setRoomName] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const [{ user }, dispatch] = useStateValue();\n\n  useEffect(() => {\n    if (roomId) {\n      db.collection(\"rooms\")\n        .doc(roomId)\n        .onSnapshot((snapshot) => setRoomName(snapshot.data().name));\n      db.collection(\"rooms\")\n        .doc(roomId)\n        .collection(\"messages\")\n        .orderBy(\"timestamp\", \"asc\")\n        .onSnapshot((snapshot) =>\n          setMessages(snapshot.docs.map((doc) => doc.data()))\n        );\n    }\n  }, [roomId]);\n\n  useEffect(() => {\n    setSeed(Math.floor(Math.random() * 5000));\n  }, []);\n\n  const sendMessage = (e) => {\n    e.preventDefault();\n    console.log(\"You typed >>>\", input);\n\n    db.collection(\"rooms\").doc(roomId).collection(\"messages\").add({\n      message: input,\n      name: user.displayName,\n      timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n    });\n\n    setInput(\"\");\n  };\n\n  return (\n    <div className=\"chat\">\n      <div className=\"chat__header\">\n        <Avatar src={`https://avatars.dicebear.com/api/human/${seed}.svg`} />\n        <div className=\"chat__headerInfo\">\n          <h3>{roomName}</h3>\n          <p>\n            sast seen{\" \"}\n            {new Date(\n              messages[messages.length - 1]?.timestamp?.toDate()\n            ).toUTCString()}\n          </p>\n        </div>\n        <div className=\"chat__headerRight\">\n          <IconButton>\n            <SearchOutlined />\n          </IconButton>\n          <IconButton>\n            <AttachFile />\n          </IconButton>\n          <IconButton>\n            <MoreVert />\n          </IconButton>\n        </div>\n      </div>\n\n      <div className=\"chat__body\">\n        {messages.map((message) => (\n          <p\n            className={`chat__message ${\n              message.name == user.displayName && \"chat__receiver\"\n            }`}\n          >\n            <span className=\"chat__name\">{message.name}</span>\n            {message.message}\n            <span className=\"chat__timestamp\">\n              {new Date(message.timestamp?.toDate()).toUTCString()}\n            </span>\n          </p>\n        ))}\n      </div>\n\n      <div className=\"chat__footer\">\n        <InsertEmoticonIcon />\n        <form>\n          <input\n            value={input}\n            onChange={(e) => setInput(e.target.value)}\n            placeholder=\"Type a message\"\n            type=\"text\"\n          />\n          <button onClick={sendMessage} type=\"submit\">\n            Send a message\n          </button>\n        </form>\n        <MicIcon />\n      </div>\n    </div>\n  );\n}\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}